# 预订表单优化 - 本人/他人预订功能

## 功能概述

优化了房间预订表单，新增了"本人预订"和"为他人预订"两种模式，让用户能够更方便地进行预订操作。

## 🎯 主要功能

### 1. 预订类型选择
- **本人预订**：自动使用当前登录用户的个人信息
- **为他人预订**：手动输入客户信息

### 2. 智能信息填充
- **自动检测**：检查用户是否登录及个人信息完整性
- **自动填充**：选择本人预订时，自动填充姓名、手机号、身份证号
- **验证提示**：信息不完整时提供完善建议

### 3. 用户体验优化
- **状态指导**：明确显示当前用户信息状态
- **快捷操作**：一键跳转到个人中心完善信息
- **智能提示**：根据不同情况提供相应指导

## 📋 实现细节

### WXML 结构
```xml
<!-- 预订类型选择器 -->
<view class="booking-type-selector">
  <view class="type-option {{bookingType === 'self' ? 'active' : ''}}" 
        data-type="self" bindtap="onBookingTypeChange">
    <view class="type-icon">👤</view>
    <view class="type-text">本人预订</view>
    <view class="type-desc">使用我的个人信息</view>
  </view>
  
  <view class="type-option {{bookingType === 'other' ? 'active' : ''}}" 
        data-type="other" bindtap="onBookingTypeChange">
    <view class="type-icon">👥</view>
    <view class="type-text">为他人预订</view>
    <view class="type-desc">输入客户信息</view>
  </view>
</view>

<!-- 条件渲染的信息展示/输入区域 -->
<view wx:if="{{bookingType === 'self'}}" class="user-info-display">
  <!-- 用户信息展示 -->
</view>

<view wx:if="{{bookingType === 'other'}}">
  <!-- 手动输入表单 -->
</view>
```

### JavaScript 逻辑
```javascript
// 核心数据
data: {
  bookingType: 'self',        // 预订类型
  userInfo: null,             // 用户信息
  isUserInfoComplete: false   // 信息完整性
}

// 关键方法
onBookingTypeChange()    // 预订类型切换
loadUserInfo()          // 加载用户信息
checkUserInfoComplete() // 检查信息完整性
fillSelfInfo()          // 填充本人信息
validateForm()          // 表单验证（根据类型）
```

### 样式设计
- **渐变背景**：预订类型选择器使用吸引人的渐变色
- **状态反馈**：清晰的选中/未选中状态
- **信息展示**：用户信息以卡片形式展示
- **警告提示**：信息不完整时的黄色警告样式

## 🔄 交互流程

### 本人预订流程
1. **检查登录状态** → 未登录则提示登录
2. **检查信息完整性** → 不完整则提示完善
3. **自动填充信息** → 使用用户个人信息
4. **简化验证** → 无需验证客户信息输入

### 为他人预订流程
1. **清空表单** → 清除自动填充的信息
2. **手动输入** → 用户输入客户信息
3. **完整验证** → 验证所有必填字段

### 状态处理
- **未登录用户**：默认显示"为他人预订"
- **已登录但信息不完整**：提示完善，支持快速跳转
- **信息完整用户**：优先推荐"本人预订"

## ✅ 优化效果

1. **提升效率**：本人预订时无需重复输入个人信息
2. **减少错误**：自动填充避免手动输入错误
3. **用户友好**：清晰的状态提示和操作指导
4. **灵活性**：支持为他人代订的场景

## 📁 涉及文件

- `pages/booking/booking.wxml` - 页面结构
- `pages/booking/booking.js` - 业务逻辑
- `pages/booking/booking.wxss` - 样式设计
- `utils/auth.js` - 用户认证模块

修复完成日期：2025年11月12日  
功能状态：✅ 已优化