# 全局消息通知系统使用说明

## 功能概述
为酒店管理系统添加了全局的消息通知功能，支持右侧弹出式通知窗口，特别适合显示新预订提醒。

## 主要功能特点

### 1. 通知类型
- **预订通知** (`booking`) - 蓝色主题，带有脉动动画效果
- **成功通知** (`success`) - 绿色主题
- **警告通知** (`warning`) - 黄色主题  
- **错误通知** (`error`) - 红色主题
- **信息通知** (`info`) - 蓝色主题

### 2. 动画效果
- 从右侧滑入动画
- 悬停时轻微左移效果
- 自动消失（可配置）
- 手动关闭按钮

### 3. 响应式设计
- 桌面端：右上角固定位置
- 移动端：全宽度适配

## 使用方法

### 在任何Vue组件中使用

```javascript
import { inject } from 'vue';

// 方法1：使用inject获取
const showNotification = inject('showNotification');
const showBookingNotification = inject('showBookingNotification');

// 方法2：使用全局方法
window.showBookingNotification('张先生预订了豪华间');

// 方法3：使用通知管理器
import notificationManager from '@/utils/notificationManager';
notificationManager.showBooking('有新的预订需要处理');
```

### 快速调用方法

```javascript
// 预订通知（最常用）
window.showBookingNotification('您有新的预订需要处理');

// 使用通知管理器的各种方法
notificationManager.showSuccess('操作成功', '房间状态更新完成');
notificationManager.showWarning('注意事项', '今日入住率已达到90%');
notificationManager.showError('系统错误', '数据库连接失败');
notificationManager.showInfo('提示信息', '系统维护将在今晚进行');
```

### 自定义通知选项

```javascript
notificationManager.show({
  type: 'booking',
  title: '新预订提醒',
  message: '张先生预订了豪华间',
  duration: 10000, // 10秒后自动消失，0表示不自动消失
});
```

## 测试功能

在欢迎页面(`/welcome`)中添加了测试按钮，包括：

1. **测试预订通知** - 随机生成客户和房型的预订通知
2. **测试成功通知** - 显示成功类型的通知
3. **测试警告通知** - 显示警告类型的通知  
4. **测试错误通知** - 显示错误类型的通知
5. **开始预订模拟** - 每15秒自动生成一次模拟预订通知
6. **停止预订模拟** - 停止自动生成模拟通知

## 实际集成建议

### 1. 在预订控制器中集成

```javascript
// 在 bookingController.js 中
const createBooking = async (req, res) => {
  try {
    // ... 创建预订逻辑
    
    // 发送通知（如果是实时系统，可以通过WebSocket推送）
    // 这里可以通过WebSocket或Server-Sent Events通知前端
    
    res.json({ success: true, booking: newBooking });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
};
```

### 2. WebSocket实时通知（推荐）

```javascript
// 在前端建立WebSocket连接
const ws = new WebSocket('ws://localhost:3000/notifications');
ws.onmessage = (event) => {
  const notification = JSON.parse(event.data);
  if (notification.type === 'new_booking') {
    notificationManager.showBooking(
      `${notification.customerName} 预订了 ${notification.roomType}`
    );
  }
};
```

### 3. 定时轮询检查

```javascript
// 每30秒检查一次新预订
setInterval(async () => {
  try {
    const response = await api.get('/bookings/recent');
    if (response.data.hasNew) {
      notificationManager.showBooking('您有新的预订需要处理');
    }
  } catch (error) {
    console.error('检查新预订失败:', error);
  }
}, 30000);
```

## 文件结构

```
src/
├── components/
│   └── NotificationPopup.vue     # 通知弹窗组件
├── utils/
│   └── notificationManager.js    # 通知管理器
├── App.vue                       # 全局组件集成
└── views/
    └── Welcome.vue               # 测试页面
```

## 样式特点

- 采用蓝白色调设计，与系统整体风格一致
- 毛玻璃效果背景
- 渐变边框和阴影
- 流畅的动画过渡效果
- 响应式布局支持

## 注意事项

1. 通知默认会在5秒后自动消失（错误通知不会自动消失）
2. 最多同时显示多个通知，会自动堆叠
3. 通知有防重复机制
4. 支持手动关闭
5. 在移动端会自适应屏幕宽度

## 后续扩展建议

1. 添加声音提醒功能
2. 集成浏览器推送通知
3. 添加通知历史记录
4. 实现通知优先级分类
5. 支持富文本内容通知